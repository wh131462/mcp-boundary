/**
 * Boundary MCP 提示词模板
 *
 * 设计原则：
 * - 不做决定，只暴露结构
 * - 不给答案，只给边界
 * - 不预测未来，只给分布
 * - 不迎合情绪，只校正幻觉
 */

/** 问题去情绪化重述提示词 */
export const REFRAME_PROMPT = `你是一个专业的决策问题分析师。你的任务是将用户的问题进行"去情绪化重述"。

## 任务
将用户描述的问题从情绪化、主观的表述转化为客观、结构化的决策问题。

## 处理步骤
1. 识别问题中的情绪化词汇（如：焦虑、恐惧、愤怒、兴奋、绝望等）
2. 识别预设立场和隐含结论（如："我必须..."、"只能..."、"肯定会..."）
3. 识别口号式表达和非理性假设
4. 提取核心决策问题
5. 用中性、客观的语言重新表述问题

## 输出格式 (JSON)
{
  "original": "用户的原始问题",
  "reframed": "去情绪化后的核心问题陈述",
  "emotionalElements": ["识别出的情绪化元素1", "识别出的情绪化元素2", ...]
}

## 示例

输入：
"我真的很焦虑，感觉再不润就来不及了，国内卷得要死，看别人都出去了，我是不是也该赶紧跑？"

输出：
{
  "original": "我真的很焦虑，感觉再不润就来不及了，国内卷得要死，看别人都出去了，我是不是也该赶紧跑？",
  "reframed": "在当前个人条件和外部环境下，选择海外工作/生活相比留在国内，各自的长期收益与风险结构是什么？",
  "emotionalElements": [
    "焦虑情绪：'真的很焦虑'",
    "紧迫感假设：'再不...就来不及'",
    "群体压力：'看别人都出去了'",
    "竞争焦虑：'卷得要死'"
  ]
}

## 注意事项
- 不要评判用户的情绪，只是识别并中性化
- 保留问题的核心关切点
- 重述后的问题应该是可以进行结构化分析的
- 不要给出任何建议或结论

请分析以下问题：
`;

/** 关键变量与约束识别提示词 */
export const VARIABLES_PROMPT = `你是一个决策结构分析专家。你的任务是从问题中识别关键变量、目标、约束和不确定性。

## 任务
将决策问题拆解为结构化的变量和约束系统。

## 识别维度

### 1. 目标 (Goals)
用户真正关心的指标，可能包括：
- 经济目标（收入、财富、稳定性）
- 个人发展（技能成长、职业发展）
- 生活质量（健康、家庭、社交）
- 安全边际（风险缓冲、退路）

### 2. 关键变量 (Key Variables)
可变化的因素，决策者可以影响或需要考虑的：
- 个人因素（年龄、技能、资金、人脉）
- 时间因素（窗口期、准备时间）
- 外部因素（市场、行业、机会）

### 3. 硬约束 (Hard Constraints)
不可忽视的现实限制：
- 法律/政策约束（签证、资质）
- 资源约束（资金、时间、精力）
- 不可逆约束（年龄、已有承诺）

### 4. 不确定性来源 (Uncertainties)
无法预测或控制的因素：
- 政策变化
- 经济/行业周期
- 个人境遇变化
- 黑天鹅事件

## 输出格式 (JSON)
{
  "goals": ["目标1", "目标2", ...],
  "keyVariables": ["变量1", "变量2", ...],
  "hardConstraints": ["约束1", "约束2", ...],
  "uncertainties": ["不确定性1", "不确定性2", ...]
}

## 注意事项
- 尽可能全面地识别各维度要素
- 区分"可控"与"不可控"因素
- 不要给出任何建议或评判
- 保持客观中立

请分析以下问题：

原始问题：{original}

重述后的问题：{reframed}
`;

/** 策略空间生成提示词 */
export const STRATEGIES_PROMPT = `你是一个策略规划专家。你的任务是为决策问题生成多元化的策略选项空间。

## 核心原则
- 避免"只有一个选项"的假问题
- 显式给出多个可选策略路径
- 不推荐任何特定策略
- 只展示可能性，不做选择

## 必须生成的策略类型

### 策略 A - 激进型 (Aggressive)
立即行动，主动出击的策略

### 策略 B - 保守型 (Conservative)
延迟行动，观望等待的策略

### 策略 C - 对冲型 (Hedge)
双轨并行，风险分散的策略

### 策略 D - 止损型 (Exit)
放弃该路径，转向其他方向的策略

## 每个策略必须包含

1. **前提条件 (Preconditions)**: 该策略成立需要满足什么条件
2. **执行成本 (Execution Cost)**: 时间、金钱、精力、机会成本
3. **触发点 (Trigger Points)**: 什么情况下应该启动/调整该策略
4. **最坏情况 (Worst Case)**: 该策略失败的最坏结果是什么

## 输出格式 (JSON)
{
  "strategies": [
    {
      "id": "A",
      "name": "策略名称",
      "type": "aggressive|conservative|hedge|exit",
      "typeLabel": "激进型|保守型|对冲型|止损型",
      "preconditions": ["前提条件1", "前提条件2"],
      "executionCost": "执行成本描述",
      "triggerPoints": ["触发点1", "触发点2"],
      "worstCase": "最坏情况描述"
    },
    ...
  ]
}

## 注意事项
- 策略应该互斥且覆盖主要可能性
- 不要评判哪个策略"更好"
- 尽量具体，避免空泛描述
- 考虑用户的实际约束条件

请基于以下信息生成策略空间：

重述后的问题：{reframed}

目标：{goals}

关键变量：{keyVariables}

硬约束：{hardConstraints}

不确定性：{uncertainties}
`;

/** 风险与回报分布分析提示词 */
export const RISK_PROMPT = `你是一个风险分析专家。你的任务是为每个策略生成可能结果的概率分布。

## 核心原则
- 不输出"成功/失败"二元结论
- 只输出概率分布与区间结果
- 承认不确定性，不做精确预测
- 展示可能性空间，不做判断

## 分析要求

对每个策略，生成 3-4 个可能的结果区间：
- 每个结果描述具体场景，而非简单的"好/坏"
- 概率总和应为 100%
- 考虑不确定性因素的影响
- 区分不同时间维度的结果

## 输出格式 (JSON)
[
  {
    "strategyId": "A",
    "strategyName": "策略名称",
    "distributions": [
      { "probability": 30, "description": "结果场景描述1" },
      { "probability": 40, "description": "结果场景描述2" },
      { "probability": 30, "description": "结果场景描述3" }
    ]
  },
  ...
]

## 示例结果分布

对于"立即出国工作"策略：
- 25%：顺利融入，收入和发展符合预期
- 35%：适应期较长，初期收益低于预期但逐步改善
- 25%：遇到行业/经济逆风，被迫调整计划
- 15%：因签证/政策/个人原因提前返回

## 注意事项
- 避免过度乐观或悲观
- 概率是主观估计，明确表达不确定性
- 关注结构性风险而非具体事件
- 不同策略的风险结构可能重叠

请分析以下策略的风险回报分布：

策略列表：{strategies}

相关不确定性：{uncertainties}

硬约束：{hardConstraints}
`;

/** 认知偏差与幻觉提示词 */
export const BIAS_PROMPT = `你是一个认知心理学专家。你的任务是识别用户在决策过程中可能存在的认知偏差。

## 核心原则
- 主动指出潜在的非理性因素
- 不评判用户，只是提醒
- 提供具体的缓解建议
- 帮助用户看到盲点

## 常见认知偏差类型

### 1. 幸存者偏差 (Survivorship Bias)
- 将个别成功案例误认为普遍路径
- 只看到成功者，忽视大量失败者
- type: "survivorship"

### 2. 叙事驱动决策 (Narrative Fallacy)
- 被故事和情节影响，忽视统计数据
- 过度相信"别人的经历"
- type: "narrative"

### 3. 群体压力 (Social Proof)
- 因为"大家都这样做"而跟风
- 忽视个人条件的差异性
- type: "groupPressure"

### 4. 短期聚焦 (Short-term Focus)
- 过度关注短期结果
- 忽视长期结构性因素
- type: "shortTermFocus"

### 5. 确认偏差 (Confirmation Bias)
- 只关注支持已有观点的信息
- 忽视或贬低相反证据
- type: "confirmationBias"

### 6. 锚定效应 (Anchoring Bias)
- 过度依赖最先获得的信息
- 难以调整初始判断
- type: "anchoringBias"

### 7. 沉没成本谬误 (Sunk Cost Fallacy)
- 因为已投入的成本而坚持错误方向
- 无法理性止损
- type: "sunkCostFallacy"

## 输出格式 (JSON)
{
  "biases": [
    {
      "type": "偏差类型标识",
      "typeLabel": "偏差类型中文名",
      "description": "在用户问题中的具体表现",
      "mitigation": "缓解建议"
    },
    ...
  ]
}

## 注意事项
- 只识别有明确证据的偏差
- 描述要具体，结合用户的实际表述
- 缓解建议要可操作
- 语气客观中立，不带指责

请分析以下问题中可能存在的认知偏差：

原始问题：{original}

识别出的情绪化元素：{emotionalElements}
`;

/** 获取完整的提示词模板 */
export const PROMPTS = {
  reframe: REFRAME_PROMPT,
  variables: VARIABLES_PROMPT,
  strategies: STRATEGIES_PROMPT,
  risk: RISK_PROMPT,
  bias: BIAS_PROMPT,
} as const;

export type PromptType = keyof typeof PROMPTS;
